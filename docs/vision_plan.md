# Образ будущего (Vision / Sims) - Design Plan

## Overview
**Vision** — это раздел внутри вкладки `/Ai`, который позволяет пользователю визуализировать свое идеальное будущее через систему Аватаров (Sims) и генеративного ИИ. 

## UI/UX: Вкладка Vision
1.  **Переключатель (Tabs)**: В верхней части `/Ai` добавляется переключатель, аналогичный `/wallet` (Wallet/Core).
    *   **Tab 1: Assistant (Чат)** — текущий функционал чата.
    *   **Tab 2: Vision ( Sims)** — новый раздел.
2.  **Состояние Аватара**:
    *   Центральный элемент — изображение Аватара пользователя.
    *   Если аватар не создан — экран онбординга (выбор базы).
3.  **Создание Аватара**:
    *   **Базовый выбор**: Мальчик/Девочка x Ребенок/Молодежь/Взрослый.
    *   **Персонализация**: Кнопка "Загрузить фото" для обучения модели на лице пользователя.
    *   **Стиль**: Выбор художественного стиля (Фотореализм, Cyberpunk, Anime, Pixar Style и т.д.).
4.  **Генератор желаний (Nano Banana style)**:
    *   Кнопка "Визуализировать желание".
    *   Категории: Имидж, Фитнес, Одежда, Место, Окружение, Вещи, События, Дом, Авто, Животные.
    *   Процесс: Пользователь выбирает желание из своего Wishboard или описывает новое → ИИ генерирует изображение Аватара в контексте этого желания.
5.  **Галерея будущего**: Сетка сгенерированных изображений, формирующих "Образ будущего".

## Экономика Аватара (Virtual Finance)
Аватар живет в мире изобилия, где его возможности в 100 раз превышают реальные возможности пользователя.

1.  **Avatar Core ($core_avatar)**:
    *   Всегда равно `user.aicore_balance * 100`.
    *   Отображается как "Капитал будущего".
2.  **Avatar Wallet ($wallet_avatar)**:
    *   Виртуальный кошелек аватара.
    *   **Механика пополнения**: При любом пополнении реального кошелька пользователя (`wallet_balance`), на кошелек аватара зачисляется сумма в 100 раз больше.
    *   Реализуется через триггер в БД (аналог `on_aicore_balance_increase_award_bonus`).
3.  **Траты**:
    *   Генерация "артефактов" (картинок желаний) стоит виртуальных $ с кошелька аватара.
    *   Это создает игровой цикл: "Пополнил реальный кошелек -> Получил х100 для аватара -> Оплатил визуализацию мечты".

## Technical Implementation Steps
1.  **Database**:
    *   Новая таблица `avatar_settings` (user_id, base_type, style, photo_url, avatar_wallet).
    *   Триггер для пополнения `avatar_wallet` при изменении `users.wallet_balance`.
2.  **API**:
    *   Server Action для сохранения настроек аватара.
    *   Интеграция с сервисом генерации изображений (например, Replicate/Leonardo/Midjourney API).
3.  **Frontend**:
    *   Компонент `AiTabsNav`.
    *   Компонент `VisionTab`.
    *   Модалка настройки аватара.
    *   Интеграция генерации в UI.

## Roadmap
*   **Этап 1**: UI переключатель и базовая верстка Vision.
*   **Этап 2**: БД-логика виртуальных финансов (100x).
*   **Этап 3**: Выбор аватара и стиля.
*   **Этап 4**: Интеграция генерации изображений.
